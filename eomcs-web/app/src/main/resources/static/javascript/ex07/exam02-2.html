<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ex07</title>
</head>
<body>
<h1>AJAX - POST 요청</h1>

<h2>일반 POST 요청</h2>
<form action="test2.jsp" method="post">
이름: <input type="text" name="name"><br>
나이: <input type="text" name="age"><br>
<button type="submit">등록</button> 
<button type="reset">초기화</button>
</form>

<hr>

<h2>AJAX POST 요청</h2>
<button id="btn1">요청</button><br>
<textarea id="ta" cols="80" rows="10"></textarea>

<script>
"use strict"

var ta = document.querySelector("#ta");

document.querySelector("#btn1").onclick = () => {
    var xhr = new XMLHttpRequest();
    
    // POST 요청은 데이터를 send()를 호출할 때 넘긴다. 
    xhr.open("POST", "test2.jsp", false);
    
    // 주의! 
    // 서버에 POST 요청으로 데이터를 보낼 때는 반드시 Content-Type 헤더를 설정하여 
    // 어떤 타입의 데이터를 보내는지 서버에 알려줘야 한다.
    // => 일반적인 form 데이터의 형식(이름=값&이름=값&...)은 다음과 같이 MIME 타입을 선언해야 한다.
    //    "application/x-www-form-urlencoded"
    //
    xhr.setRequestHeader(
        "Content-Type", 
        "application/x-www-form-urlencoded");
    
    var queryString = "name=" + window.encodeURIComponent("홍길동") + "&age=20";
    console.log(queryString);
    
    xhr.send(queryString);
    
    ta.value = xhr.responseText;
};

</script>
</body>
</html>






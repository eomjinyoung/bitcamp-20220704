<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ajax 파일 업로드</title>
</head>
<body>
<h1>AJAX 멀티파트 전송 - 파일 선택 즉시 전송하기</h1>
<pre>
1) jQuery의 파일 업로드 관련 플러그인을 설치한다.
   > npm init
   > npm install jquery@1.12.4 --save
   > npm install bootstrap --save
   > npm install popper.js@^1.14.3 --save
   > npm install blueimp-file-upload --save 
2) HTML에 업로드 관련 자바스크립트 라이브러리 추가 
3) input 태그 추가
   - form 태그와 submit 타입의 버튼은 필요 없다.
   - 대신 input 태그에 서버측 URL를 지정한다.
   - 여러 개를 선택하고 싶다면 multiple 속성을 추가한다.
4) jquery.fileupload() 함수
   - 버튼을 클릭 했을 때 서버에 비동기 요청하도록 설정한다.
   - 바로 파일을 업로드 하라는 의미가 아니다. 
   - 여러 개의 파일을 선택했을 때, 각 파일마다 따로 비동기 요청을 수행함. 
   - 각각의 파일에 대해 업로드가 완료되면 done() 함수가 호출된다.
</pre>

<input id="fileupload" type="file" name="files" 
       data-url="upload.jsp" multiple><br>
       
<hr>
<p><img id="photoImg" width="100"></p>

<script src="../node_modules/jquery/dist/jquery.min.js"></script>
<script src="../node_modules/blueimp-file-upload/js/vendor/jquery.ui.widget.js"></script>
<script src="../node_modules/blueimp-file-upload/js/jquery.iframe-transport.js"></script>
<script src="../node_modules/blueimp-file-upload/js/jquery.fileupload.js"></script>
<script>
"use strict"

// 해당 태그에 대해 추가적으로 설정하고 싶다면,
// fileupload() 함수를 호출할 때 아규먼트로 그 설정 값을 넘겨라!
// 아규먼트 값은 자바스크립트 객체에 담아 넘긴다.

$('#fileupload').fileupload({
  // 서버가 응답을 완료했을 때 어떤 작업을 수행하고 싶다면 
  // "done" 이라는 이름으로 함수를 등록하라!
  // 그러면 서버로부터 응답을 받았을 때 이 함수가 호출될 것이다.
  // 이렇게 특정 상태에 놓이면 호출되는 함수를 'callback 함수'라 부른다.
  // click 이벤트가 발생했을 때 호출되는 함수도 'callback 함수'이다.
  // 물론 다른 말로 'listener'라 부르기도 한다.
  done: function(e, data) {
    console.log('done()...');
  }
});

</script>

</body>
</html>






